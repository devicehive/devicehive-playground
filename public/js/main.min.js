!function(i){function n(n){return i("#footer-email").on("blur, keyup",function(){i("span#mailchimp-error").text("")}),i.ajax({type:n.attr("method"),url:n.attr("action"),data:n.serialize(),cache:!1,dataType:"json",contentType:"application/json; charset=utf-8",error:function(i){alert("Oops, something went wrong!")},success:function(n){""!==i("#footer-email").val()&&("success"!==n.result?(-1!==n.msg.indexOf("is already subscribed")?i("span#mailchimp-error").text("This email address is already subscribed to the News Digest"):i("span#mailchimp-error").text(n.msg),i("#footerSubscribeBtn").prop("disabled",!0)):(i("#footer-email").val(""),i("#subscribedMsg").fadeIn(200),setTimeout(function(){i("#subscribedMsg").fadeOut(200)},2e3)))}}),!1}var o={init:function(i){this.config=i,this.bindEvents()},bindEvents:function(){this.validate(this.config.form),this.enableButton(this.config.form,this.config.field,this.config.btn)},validate:function(n){i.validator.methods.emailRegex=function(i,n){return this.optional(n)||/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/gim.test(i)},i(n).validate({rules:{email:{emailRegex:!0}},messages:{email:{emailRegex:"Please enter a valid email address."}},submitHandler:function(n){i(n).submit()}})},enableButton:function(i,n,o){n.on("blur keyup",function(){i.valid()?o.prop("disabled",!1):o.prop("disabled",!0)})}},e={init:function(n){var o=this;this.config=n,this.bindEvents(),this.footerBar=this.config.footerBar.clone(),window.innerWidth<992&&(o.config.navbar.hide(),i(window).on("orientationchange",function(){o.hideMenu()})),i(window).on("resize",function(){i("body").removeClass(o.config.classToBodyAdd),window.innerWidth<992?o.config.navbar.hide():o.config.navbar.show()})},bindEvents:function(){var n=this,o=i("body");n.config.menuBtn.on("click",this.processMenu),n.config.navItem.on("click",function(){o.hasClass(n.config.classToBodyAdd)&&(i("#headerNav").slideUp(),o.removeClass(n.config.classToBodyAdd))})},processMenu:function(){var n=e;i("body").hasClass(n.config.classToBodyAdd)?n.hideMenu():n.showMenu()},hideMenu:function(){i("body").removeClass(this.config.classToBodyAdd),this.config.navbar.slideUp()},showMenu:function(){i("body").addClass(this.config.classToBodyAdd),this.config.navbar.append(this.footerBar).slideDown()}},t={init:function(i){this.config=i,this.processTabs(),this.hideTabs()},processTabs:function(){var n=t;this.config.tabs.find(this.config.tab).each(function(o,e){i(e).on("click",n.config.tabBtn,function(){i(this).hasClass("open")?(i(this).removeClass("open"),i(e).find(n.config.tabContent).slideUp()):(i(this).addClass("open"),i(e).find(n.config.tabContent).slideDown())})})},hideTabs:function(){this.config.tabs.find(this.config.tabContent).hide()}},s={init:function(i){this.config=i,this.bindEvents()},bindEvents:function(){var n=s;this.config.panel.each(function(o,e){i(e).on("click",n.config.copyBtn,function(){var o=i(e).find(s.config.textToCopy),t=i(e).find(n.config.copiedName).text();n.copyToClipboard(o),n.showMsg(t)})})},copyToClipboard:function(n){var o=i("<input>");i("body").append(o),o.val(i(n).text()).select(),document.execCommand("copy"),o.remove()},showMsg:function(i){this.config.copyMsg.text(i+"copied").addClass("copied"),setTimeout(function(){s.config.copyMsg.text("").removeClass("copied")},2e3)}},a={init:function(i){this.config=i,this.checkUser()},clearCookies:function(){Cookies.remove("connect.sid"),window.location="/logout"},getCurrentUser:function(){this.config.signIn.hide(),this.config.detailPage.show(),this.loadContent()},checkUser:function(){Cookies.get("connect.sid")?this.getCurrentUser():this.userIsMissing()},loadContent:function(){var n=this;this.config.loader.show(),i.get("info",function(i){n.config.detailPage.html(i)}).done(function(){n.config.loader.hide(),i(n.config.logoutBtn).on("click",n.clearCookies),s.init({panel:i(".hasCopy"),copyBtn:".copyBtn",copyMsg:i("#copyMsg"),textToCopy:"code",copiedName:".copy__heading"}),t.init({tabs:i("#detailsTabs"),tab:".details__tab",tabBtn:".tab__btn",tabContent:".tab__content"})}).fail(function(o){n.config.loader.hide(),n.config.relogin.show(),i(n.config.logoutBtn).on("click",n.clearCookies),o.status<404?n.config.keyExpiredMsg.show():n.config.serverErrorMsg.show()})},userIsMissing:function(){this.config.signIn.show(),this.config.detailPage.hide(),i(".mobile__logout").hide()}};i(function(){var t=i(".header");i(window).scrollTop()>100?t.addClass("bg-header"):t.removeClass("bg-header"),i(window).on("scroll",function(){i(window).scrollTop()>100?t.addClass("bg-header"):t.removeClass("bg-header")});var s=i("#footerEmailForm");s.length>0&&i(s.find('input[type="submit"]')).bind("click",function(i){i&&i.preventDefault(),n(s)}),a.init({logoutBtn:".logout-btn",loader:i(".loading"),signIn:i("#sign-in"),detailPage:i("#playground-detail"),keyExpiredMsg:i("#key-expired"),serverErrorMsg:i("#server-error"),relogin:i("#playground-relogin")}),e.init({footerBar:i("#footerLinks"),menuBtn:i("#mobileBtn"),classToBodyAdd:"mobile-menu-visible",navbar:i("#headerNav"),navItem:i(".nav__item")}),o.init({form:i("#footerEmailForm"),btn:i("#footerSubscribeBtn"),field:i("#footer-email")})})}(jQuery);